---
title: "Class2"
author: "KWIZERA Eric"
date: "2025-10-16"
output: html_document
---


```{r}
data1 <- read.table(text="
Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 4 6 30 140 67 47 23 39 134 80
2 10 2 29 164 72 81 28 63 211 132
", header=TRUE)
barplot(as.matrix(data1), main="Confirmed cases Vs Gender", beside=TRUE,
        col=c("gold3","red"))
legend("topright", c("Male","Female"), cex=0.5, bty="n", fill=c("gold3","red"))

```
```{r}
data3 <- read.table(text="
sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 867 582 1802 12003 3059 9205 5346 7269 5933 324
2 842 436 1805 11785 3508 10908 4902 7883 5901 464
", header=TRUE)
barplot(as.matrix(data3), main="COVID-19 test Vs Gender", beside=TRUE,
        col=c("blue","purple"))
legend("topleft", c("Male","Female"), cex=1.3, bty="n", fill=c("blue","purple"))

```
```{r}
data2 <- read.table(text="
Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 0 0 1 9 8 7 1 4 11 22
2 11 3 41 242 104 78 44 86 244 147
3 3 5 17 53 27 43 6 12 90 43
", header=TRUE)
barplot(as.matrix(data2), main="Confirmed cases Vs Age categories", beside=TRUE,
        col=c("green","blue","purple"))

legend("topleft", 
       c("Less than 15 years","15-49 years","Above 50"), 
       cex=1.3, bty="n", fill=c("green","blue","purple"))

```
```{r}
months<-c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","Feb
_2023","Mar_2023","Apr_2023","May_2023","June_2023")
Confirmed_covid<-c(14,8,59,304,139,128,51,102,345,212)
plot(Confirmed_covid, type = "l",pch=21, col = "red",ylim=c(0,350),
xaxt="n", ylab = "Number of patients ",
main = "Confirmed cases Vs treatment ")
treatment<- c(12,0,26,217,104,57,12,47,23,20)
lines(treatment, col="blue",lty=2)
legend("topleft", legend=c("Received treatment", "Confirmed"),cex=0.5,
fill = c("blue","red"))
axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
_2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))
```
```{r}
months<-c("sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","feb
_2023","Mar_2023","Apr_2023","May_2023", "June_2023")
number_of_test<-c(1709, 1018, 3607,23788,6567,20113,10248,15152,11834,
7891)
plot(number_of_test, type = "o", col = "blue",ylim=c(0,24000),
xaxt="n", ylab = "Number of Test",
main = "COVID 19 Test")
axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
_2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))
```
**ggplot2**

ggplot2 provides a set of tools that allows you to visualize complex data sets in a new creative way -some work need some packages to get done. -some of the graph are created using R’s base graphics system
```{r}
###install.packages("ggplot2") library(ggplot2)
library(ggplot2) 
```
####**let us explore the data mcars**

```{r}
data(mtcars)
#dotchart(mtcars$mpg,labels=row.names(mtcars),ce#x = 0.,main="miles per Gallon of car #model",xlab = "MPG") 
table(mtcars$cyl)
```
```{r}
#barplot(mtcars$cyl)
barplot(table(mtcars$cyl),
        main="Distribution of car Cylinder counts",
        xlab="Number of cylinders",
        ylab="Number of cars")

```
```{r}
barplot(table(mtcars$cyl),
        main="Distribution of car Cylinder counts",
        xlab="Number of cylinders",
        ylab="Number of cars",
        horiz=TRUE)

```
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",ylab=" M
iles per Gallon")
```
```{r}
plot(mtcars$mpg ~ mtcars$wt,
     main="Automobile Data",
     xlab="Weight",
     ylab="Miles per Gallon")

plot(mtcars$mpg ~ mtcars$wt,
     pch=17,
     main="Automobile Data",
     xlab="Weight",
     ylab="Miles per Gallon")

```
```{r}
plot(mtcars$mpg ~ mtcars$wt,
     pch=21,
     main="Automobile Data",
     xlab="Weight",
     ylab="Miles per Gallon")

```
```{r}
plot(mtcars$mpg ~ mtcars$wt,
     type="l",     # line plot
     lty=2,        # dashed line
     lwd=2,        # line width
     col="red",
     main="Automobile Data",
     xlab="Weight",
     ylab="Miles per Gallon")

```
**in ggplot2, plots are created by chaining together function using (+)sign. Each function modify the plot created up to that point**
```{r}
library(ggplot2)
ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point()+
labs(title = "Automobile Data",x="Weight",y="Miles per Galon")
```
```{r}
library(ggplot2)
ggplot(data = mtcars, aes(x = wt, y = mpg)) +
  geom_point(pch = 17, color = "blue", size = 1) +
  geom_smooth(method = "lm", color = "green") +
  labs(title = "Automobile Data",x = "Weight",y = "Miles per Gallon")
## `geom_smooth()` using formula = 'y ~ x'
```
```{r}
f0<-ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(shape=24, fill=1,size=1)+
  geom_smooth(method="lm",color="blue") 
f0
## `geom_smooth()` using formula = 'y ~ x'

```
```{r}
f1<-f0+theme_bw()
f1
## `geom_smooth()` using formula = 'y ~ x'
```

```{r}
f2<-f1+
theme(panel.grid = element_line(linetype = "dotted",color = "Black"))
f2
## `geom_smooth()` using formula = 'y ~ x'
```
**Grouping displays two or more groups of observations in a single plot**
```{r}
data(mtcars)
mtcars$am<-factor(mtcars$am, levels =c(0,1),
labels= c("Automatic","Manual"))
mtcars$vs<-factor(mtcars$vs, levels =c(0,1),
labels=c("V-Engine","Straight Engine"))
mtcars$cyl<-factor(mtcars$cyl)
ggplot(data=mtcars,aes(x=hp,y=mpg,shape=cyl,color=cyl))+
geom_point(size=3)+
facet_grid(vs~am)+
labs(title = "Automobile Data by Engine Type",x="HorsePower",y="Miles
per Gallon")
```

```{r}
data(singer,package="lattice")
ggplot(singer,aes(x=voice.part,y=height))+geom_boxplot()
```
###Use the following function:
geom_bar() geom_boxplot() geom_density() geom_histogram() geom_hline() geom_jitter() geom_line() #geom_point() geom_rug() #geom_smooth() geom_text() geom_violin() geom_vline() ## Basic data management **cbind and rbind**

While combining column wise, the number of rows must match but row names are ignored. when combining row-wise, both the number and the names of columns must match.

```{r}
data2<- data.frame(x=1:3, y=c("a","b","c"))
str(data2)
```

```{r}
(cbind(data2,data.frame(z=3:1)))
```

```{r}
(rbind(data2,data.frame(x=10,y="z")))
```
### Create another Variable
```{r}
data_class<-read.table("E:/Datasets/New folder/Book1.txt", header = TRUE)
variable.names(data_class)
```
```{r}
head(data_class,n=5)
```
```{r}
tail(data_class)
```
```{r}
data_class[,1]
```
```{r}
summary(data_class$WEIGHT)
```
```{r}
length(data_class$WEIGHT)
```
```{r}
data_class[,-1]
```
```{r}
attach(data_class)
(BMI<-WEIGHT/(HEIGHT/100)^2)
```
```{r}
(BMI<-round(WEIGHT/(HEIGHT/100)^2,digit=1))
```
```{r}
head(cbind(data_class,BMI))
```
```{r}
tail(cbind(data_class,BMI),n=10)
```
```{r}
detach(data_class)
```
### Summary of BMI
```{r}
summary(BMI)
```
```{r}
hist(data_class$HEIGHT)
```
```{r}
hist(data_class$WEIGHT,col = "blue",main = "Sample Histogram")
```
```{r}
stem(BMI,scale=2)
```
### Subsetting

#### Use of $, []. or [[]]

Creation of leadership data Interest: How men and women differ in the way they lead their organizations. 5 questions were asked in this study. Example of the question: Do men and women in management position differ in the degree to which they defer to superiors? 1: strongly disagree, 2: disagree, 3:neither agree nor disagree,4: agree, 5: strongly agree
```{r}
manager <- c(1,2,3,4,5)
country<- c("US","US","UK","UK","UK") 
gender<-c("M","F","F","M","F") 
age<-c(32,45,25,39,99) 
q1<-c(5,3,3,3,2) 
q2<-c(4,5,5,3,2) 
q3<-c(5,2,5,4,1) 
q4<-c(5,5,5,NA,2) 
q5<-c(5,5,2,NA,1)
leadership<-data.frame(manager,country, gender, age, q1,q2,q3,q4,q5,stringsAsFactors = FALSE)
leadership<-data.frame(manager,country, gender, age, q1,q2,q3,q4,q5) 
str(leadership)

```
```{r}
names(leadership)
```
What you can do - combine the score of the five questions -handle the missing values - create a dataset of what you want -create age group or age categories - 99 indicate the value is missing

### Missing value
```{r}
leadership$age[leadership$age==99]<-NA
leadership$agecat[leadership$age >75]<-"Elder"
leadership$agecat[leadership$age>=35 & leadership$age<=75]<-"Middle Age
d"
leadership$agecat[leadership$age <35]<- "Young"
```
### One way to handle missing value
Deleting all observations with missing data ( Listwise deletion) is one of the several methods of handling incomplete datasets. Note: You can also replacing the missing value by the average of the remaining data.

```{r}
is.na(leadership[,5:9])
```
```{r}
newdata<-na.omit(leadership)
newdata
```
### Sorting data
```{r}
order(leadership$age)
```

```{r}
newdata2<-leadership[order(leadership$age),]
```
### Merging data sets

To merge two data frame horizontally, you use merge() function. In most cases, two data frames are joined by one or more common key variables. -example 1: merge(dataframeA, dataframeB,by=“ID”) -example 2: merge(dataframeA,dataframeB, by=c(“ID”,“country”)) the second merge the two dataframes by ID and country

To join two data frame( datasets) vertically, use rbind() function: Note that the two data set must have the same variables

### Subset (selecting variables,dropping variables,selecting observation )

```{r}
newdata3<-leadership[,c(5:9)]
myvars<-c("q1","q2","q3","q4","q5")
newdata3<-leadership[myvars]
newdata4<-leadership[,c(-1,-2)]
newdata4<-leadership[,-(1:5)]
newdata5<-leadership[,c(-1,-7)]
leadership[[4]]
```

```{r}
leadership$age
```

```{r}
newdata6<-leadership[c(-1,-3),]
newdata6<-leadership[c(2,4,5),]
newdata7<-subset(leadership,age>=35|age<24,select=c(q1,q2,q3,q4,q5))
attach(leadership)
```

```{r}
#newdata7<-leadership[gender="M" & age>30,]
newdata7<-leadership[gender=="M" & age>30,]
detach(leadership)
```

### Data management with dyplr
Data source from the package nycflights13 and ggplot2 This data contains all 336,776 flights that departed from New York city in 2013.

### Data management with dyplr
Data source from the package nycflights13 and ggplot2 This data contains all 336,776 flights that departed from New york city in 2013.

```{r}
#install.packages("nycflights13")
#install.packages("tidyverse")
library(nycflights13)
```
```{r}
#install.packages("dplyr") 
library(dplyr)
```
```{r}
#library(tidyverse)
```

### The function filter()
```{r}
#rm(list = ls())
str(flights)
```
```{r}
#attach(flights)
jan<-filter(flights,month==1)
jan
```
```{r}
newyear<-filter(flights,month==1, day==1)
newyear
```

```{r}
dec25<-filter(flights,month==12, day==25)
dec25
```

```{r}
jan_dec<-filter(flights,month==1|month==12)
jan_dec
```
```{r}
nov_dec<-filter(flights,month %in% c(11,12))
#detach(flights)
```

### The function arrange()

This change the order
```{r}
data_10<-arrange(flights,year,month,day)
arrange(flights,desc(arr_delay))
```

### The function select
This helps to selects only the variables you are interested in

```{r}
time_var<-select(flights, year,month, day)
select(flights, year:day)
```
```{r}
select(flights,-(year:day))
```
### The function mutate
This is useful in adding a new Variable

```{r}
## create a small data set
flights2<-select(flights,year:day,ends_with("delay"),distance,air_time)
(mutate(flights2,gain=arr_delay-dep_delay, speed=distance/air_time*60))
```

